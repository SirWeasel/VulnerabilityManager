# -*- coding: utf-8 -*-
from __future__ import unicode_literals
from django_mysql.models import ListCharField
from datetime import datetime
from django.db import models

# Create your models here.
from assets.models import Asset

class ScanProfile(models.Model):
    profile_name = models.CharField(max_length=60,null=False,blank=False)
    profile_type = models.CharField(
        max_length=3,
        choices=(('Auth','Authenticated')('Unauth', 'Unauthenticated')),
        default='Unauth',
    ),
    profile_port_type = models.CharField(
        max_length=3,
        choices=(('T','TCP')('U', 'UDP')),
        default='T',
    )

class Scan(models.Model):
    scan_id = models.IntegerField(auto_created=True,primary_key=True)
    scan_title = models.CharField(max_length=60,null=False,blank=False)
    create_date = models.DateTimeField(default=datetime.now, blank=True)
    last_scan = models.DateTimeField(auto_now_add=False, auto_now=True)
    scan_targets = models.ListCharField(
        base_field=models.ForeignKey(Asset,on_delete=models.CASCADE)
    )
    profile = models.ForeignKey(ScanProfile,on_delete=models.CASCADE)

