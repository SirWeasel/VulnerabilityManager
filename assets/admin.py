# -*- coding: utf-8 -*-
from __future__ import unicode_literals

from django.contrib import admin
from django.contrib.contenttypes.models import ContentType
from django.http import HttpResponseRedirect
# Register your models here.
from .models import Asset, Credential


class AssetAdmin(admin.ModelAdmin):
    def launch_scan(self, request, queryset):
        selected = request.POST.getlist(admin.ACTION_CHECKBOX_NAME)
        ct = ContentType.objects.get_for_model(queryset.model)
        return HttpResponseRedirect("admin/scans/scan/add/", )
    launch_scan.short_description = "Launch a scan with selected Assets"

    list_display = [f.name for f in Asset._meta.fields]
    actions = [launch_scan]
    class Meta:
        model = Asset




class CredentialAdmin(admin.ModelAdmin):
    class Meta:
        model = Credential



admin.site.register(Asset,AssetAdmin)
admin.site.register(Credential,CredentialAdmin)